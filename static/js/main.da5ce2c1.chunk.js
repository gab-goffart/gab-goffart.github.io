(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,n){},13:function(e,t,n){"use strict";n.r(t);for(var a=n(0),o=n.n(a),r=n(3),i=n.n(r),c=n(1),l=function(e){var t=e.state,n=e.dispatch,r=Object(a.useRef)(null),i=Object(a.useState)(null),l=Object(c.a)(i,2),s=l[0],d=l[1],u=Object(a.useState)(null),f=Object(c.a)(u,2),m=f[0],h=f[1];Object(a.useEffect)(function(){s=r.current.getContext("2d"),d(s),s.lineWidth="2"},[]),Object(a.useEffect)(function(){s.fillStyle="#000",s.strokeStyle="#fff",s.fillRect(0,0,400,800);for(var e=0;e<t.board.length;e++)for(var n=0;n<t.board[e].length;n++)t.board[e][n]&&(s.fillStyle=t.board[e][n],s.fillRect(40*n,40*e,40,40),s.strokeRect(40*n,40*e,40,40))}),Object(a.useEffect)(function(){return m=setInterval(b,t.time),h(m),function(){h(function(e){return window.clearInterval(e),null})}},[t.time]);var b=function(){n("MOVE_DOWN")};return o.a.createElement("div",{className:"board box has-background-info has-text-centered"},o.a.createElement("canvas",{ref:r,height:800,width:400}))},s=function(e){var t=e.isDead,n=e.score,r=e.dispatch;Object(a.useEffect)(function(){t?document.querySelector(".modal").className+=" is-visible":document.querySelector(".modal").className="modal"},[t]);var i=function(e){document.querySelector(".modal").className="modal"};return o.a.createElement("div",{className:"modal",onClick:i},o.a.createElement("div",{className:"modal-content"},o.a.createElement("div",{className:"modal-header"},o.a.createElement("h3",null,"You died!")),o.a.createElement("div",{className:"modal-body"},o.a.createElement("p",null,"Looks like you died! :(  You scored ",n,". Would you like to play again?")),o.a.createElement("div",{className:"modal-footer"},o.a.createElement("div",{className:"buttons"},o.a.createElement("button",{className:"button is-success is-rounded",onClick:function(e){r("RESET")}},"Yes"),o.a.createElement("button",{className:"button is-danger is-rounded",onClick:i},"No")))))},d=function(e){var t=e.score;return o.a.createElement("div",{className:"score box has-background-warning has-text-centered"},o.a.createElement("h3",{className:"title is-3"},"Your score : ",o.a.createElement("br",null),t))},u=function(e){for(var t=e.piece,n=e.color,r=null,i=[],c=Object(a.useRef)(null),l=0;l<4;l++){i[l]=[];for(var s=0;s<4;s++)i[l][s]=null}return Object(a.useEffect)(function(){(r=c.current.getContext("2d")).lineWidth="2",r.strokeStyle="#fff",r.fillStyle="#000",r.fillRect(0,0,c.current.width,c.current.height);for(var e=0;e<t.length;e++)for(var a=0;a<t[e].length;a++)t[e][a]&&(r.fillStyle=n,r.fillRect(50*a,50*e,50,50),r.strokeRect(50*a,50*e,50,50))},[t]),o.a.createElement("div",{className:"next box has-background-warning has-text-centered"},o.a.createElement("h3",{className:"title is-3"},"Your next piece :"),o.a.createElement("canvas",{ref:c,height:200,width:200}))},f=function(e){var t=e.dispatch;return o.a.createElement("div",{className:"menu box has-background-warning has-text-centered"},o.a.createElement("h3",{className:"title is-3"},"Menu"),o.a.createElement("div",{className:"buttons is-vertical"},o.a.createElement("button",{className:"button is-fullwidth is-rounded",onClick:function(e){t("RESET"),document.activeElement.blur()}},"Reset"),o.a.createElement("button",{className:"button is-fullwidth is-rounded",onClick:function(e){t("TOGGLE"),document.activeElement.blur()}},"Play / Pause")))},m=function(e){var t=e.gameState;return o.a.createElement("div",{className:"state box has-background-warning has-text-centered"},o.a.createElement("h3",{className:"title is-3"},"Currently ",t))},h=(n(12),n(4)),b=n(5),x=[[[[0,1,1],[1,1,0],[0,0,0]],[[0,1,0],[0,1,1],[0,0,1]],[[0,0,0],[0,1,1],[1,1,0]],[[1,0,0],[1,1,0],[0,1,0]]],[[[1,1,0],[0,1,1],[0,0,0]],[[0,0,1],[0,1,1],[0,1,0]],[[0,0,0],[1,1,0],[0,1,1]],[[0,1,0],[1,1,0],[1,0,0]]],[[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]],[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]]],[[[0,1,0],[0,1,0],[1,1,0]],[[1,0,0],[1,1,1],[0,0,0]],[[0,1,1],[0,1,0],[0,1,0]],[[0,0,0],[1,1,1],[0,0,1]]],[[[0,1,0],[0,1,0],[0,1,1]],[[0,0,0],[1,1,1],[1,0,0]],[[1,1,0],[0,1,0],[0,1,0]],[[0,0,1],[1,1,1],[0,0,0]]],[[[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0]],[[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0]],[[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0]],[[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0]]],[[[0,0,0],[1,1,1],[0,1,0]],[[0,1,0],[1,1,0],[0,1,0]],[[0,1,0],[1,1,1],[0,0,0]],[[0,1,0],[0,1,1],[0,1,0]]]],v=["#fc9105","#0fbc1d","#16fcf0","#1622fc","#fc1631","#f702ca","#f2f204"],E=Math.floor(Math.random()*x.length),g=Math.floor(Math.random()*x.length),p=[],y=0;y<20;y++){p[y]=[];for(var k=0;k<10;k++)p[y][k]=null}var O={index:E,activeIndex:0,shape:x[E],active:x[E][0],color:v[E],nextIndex:g,nextShape:x[g],nextActive:x[g][0],nextColor:v[g],position:{x:3,y:0},board:p,score:0,time:1e3,isPlaying:!0,isDead:!1},N=function(e,t){var n=Object(b.a)({},e);switch(n.board=w(n.board,n.active,n.position),t){case"MOVE_LEFT":if(!n.isPlaying)break;n.position.x--,S(n.board,n.active,n.position)&&n.position.x++;break;case"MOVE_RIGHT":if(!n.isPlaying)return n;n.position.x++,S(n.board,n.active,n.position)&&n.position.x--;break;case"MOVE_DOWN":if(!n.isPlaying)break;if(n.position.y++,S(n.board,n.active,n.position)){if(n.position.y--,!M(n.position))return n.isPlaying=!1,n.isDead=!0,n;n.board=I(n.board,n.active,n.position,n.color),n.position.x=3,n.position.y=0,n.score+=50;var a=P(n.board);a.nb>0&&(n.board=a.board,console.log("flushed"),n.time=n.time-2*a.nb,n.score+=400*Math.pow(2,a.nb)),n.index=n.nextIndex,n.activeIndex=0,n.shape=n.nextShape,n.active=n.nextActive,n.color=n.nextColor,n.nextIndex=Math.floor(Math.random()*x.length),n.nextShape=x[n.nextIndex],n.nextActive=x[n.nextIndex][0],n.nextColor=v[n.nextIndex]}break;case"DROP":if(!n.isPlaying)return n;for(;!S(n.board,n.active,n.position);)n.position.y++;if(n.position.y--,!M(n.position))return n.isPlaying=!1,n.isDead=!0,n;n.board=I(n.board,n.active,n.position,n.color),n.position.x=3,n.position.y=0,n.score+=50;var o=P(n.board);o.nb>0&&(n.board=o.board,n.time=n.time-2*o.nb,n.score+=400*Math.pow(2,o.nb)),n.index=n.nextIndex,n.activeIndex=0,n.shape=n.nextShape,n.active=n.nextActive,n.color=n.nextColor,n.nextIndex=Math.floor(Math.random()*x.length),n.nextShape=x[n.nextIndex],n.nextActive=n.nextShape[0],n.nextColor=v[n.nextIndex];break;case"ROTATE":if(!n.isPlaying)break;n.activeIndex++,n.active=n.shape[n.activeIndex%n.shape.length],S(n.board,n.active,n.position)&&(n.activeIndex--,n.active=n.shape[n.activeIndex%n.shape.length]);break;case"TOGGLE":if(n.isDead)break;n.isPlaying=!n.isPlaying;break;case"RESET":n.position.x=3,n.position.y=0,n.time=O.time,n.board=j(n.board),n.index=Math.floor(Math.random()*x.length),n.shape=x[n.index],n.active=n.shape[0],n.color=v[n.index],n.nextIndex=Math.floor(Math.random()*x.length),n.nextShape=x[n.nextIndex],n.nextActive=x[n.nextIndex][0],n.nextColor=v[n.nextIndex],n.score=0,n.isPlaying=!0,n.isDead=!1}return n.board=I(n.board,n.active,n.position,n.color),n},w=function(e,t,n){return I(e,t,n,null)},I=function(e,t,n,a){for(var o=0;o<t.length;o++)for(var r=0;r<t[o].length;r++)t[o][r]&&(e[n.y+o][n.x+r]=a);return e},S=function(e,t,n){for(var a=0;a<t.length;a++)for(var o=0;o<t[a].length;o++)if(t[a][o]){if(n.y+a>=20)return!0;if(n.x+o<0||n.x+o>=10)return!0;if(e[n.y+a][n.x+o])return!0}return!1},M=function(e){return 0!==e.y},P=function(e){for(var t=!0,n=0,a=0;a<e.length;a++){for(var o=0;o<e[a].length;o++)null===e[a][o]&&(t=!1);t&&(n++,e=R(e,a)),t=!0}return{nb:n,board:e}},R=function(e,t){for(var n=t;n>0;n--)e[n]=Object(h.a)(e[n-1]);for(var a=0;a<e[0].length;a++)e[0][a]=null;return e},j=function(e){for(var t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++)e[t][n]=null;return e},C=function(e){var t=Object(a.useReducer)(N,O),n=Object(c.a)(t,2),r=n[0],i=n[1];Object(a.useEffect)(function(){return document.addEventListener("keydown",h),function(){document.removeEventListener("keydown",h)}},[]);var h=function(e){switch(e.keyCode){case 32:i("DROP");break;case 37:i("MOVE_LEFT");break;case 38:i("ROTATE");break;case 39:i("MOVE_RIGHT");break;case 40:i("MOVE_DOWN")}};return o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"grid"},o.a.createElement("h1",{className:"has-text-centered main-header"},"Tetris game"),o.a.createElement(l,{state:r,dispatch:i}),o.a.createElement(u,{piece:r.nextActive,color:r.nextColor}),o.a.createElement(d,{score:r.score}),o.a.createElement(m,{gameState:r.isDead?"Dead":r.isPlaying?"Playing":"Paused"}),o.a.createElement(f,{dispatch:i})),o.a.createElement(s,{isPlaying:r.isPlaying,isDead:r.isDead,score:r.score,dispatch:i}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(C,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},6:function(e,t,n){e.exports=n(13)}},[[6,1,2]]]);
//# sourceMappingURL=main.da5ce2c1.chunk.js.map